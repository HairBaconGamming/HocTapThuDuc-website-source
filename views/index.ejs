<%- include('partials/header') %>

<link rel="stylesheet" href="/css/styleIndex.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<section class="hero-section">
    <div class="hero-bg-shape shape-1"></div>
    <div class="hero-bg-shape shape-2"></div>

    <div class="hero-container">
        
        <% if (!user) { %>
            <div class="hero-content reveal-holder creative-reveal-up" style="transition-delay: 0.2s">
                <div class="hero-badge animate__animated animate__bounceIn">
                    <i class="fas fa-seedling text-accent-green"></i> Giai ƒëo·∫°n kh·ªüi t·∫°o - Beta
                </div>
                
                <h1 class="hero-title">
                    K·∫øt n·ªëi tri th·ª©c,<br>
                    <span class="text-gradient">X√¢y d·ª±ng c·ªông ƒë·ªìng</span>
                </h1>
                
                <p class="hero-desc">
                    Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi ng√¥i nh√† chung c·ªßa h·ªçc sinh Th·ªß ƒê·ª©c! N∆°i chia s·∫ª t√†i li·ªáu, b√†i gi·∫£ng v√† c√πng nhau chinh ph·ª•c nh·ªØng ƒëi·ªÉm 10 r·ª±c r·ª°.
                </p>
                
                <div class="hero-actions animate__animated animate__fadeInUp animate__delay-1s">
                    <a href="/register" class="btn-main">
                        <i class="fas fa-user-plus"></i> ƒêƒÉng k√Ω th√†nh vi√™n
                    </a>
                    <a href="/courses" class="btn-outline">
                        D·∫°o m·ªôt v√≤ng
                    </a>
                </div>
            </div>

            <div class="hero-visual reveal-holder creative-reveal-right" style="transition-delay: 0.5s">
                <img src="https://i.ibb.co/tMVgJBqG/z7399789838688-0ce675f8fa3d50416bfe1501102711d3.jpg" alt="X√¢y d·ª±ng c·ªông ƒë·ªìng">
                <div class="floating-card fc-1">
                    <i class="fas fa-heart text-danger"></i> D√†nh cho Tƒêers
                </div>
            </div>

        <% } else { %>
            <div class="hero-content reveal-holder creative-reveal-up" style="transition-delay: 0.2s">
                <div class="hero-badge" style="background: #e0f2fe; color: var(--primary); border-color: #bae6fd;">
                    <i class="fas fa-hand-sparkles"></i> H·∫ø l√¥, <b><%= user.username %></b>! ‚úåÔ∏è
                </div>
                
                <h1 class="hero-title">
                    H√¥m nay ch√∫ng ta<br>
                    <span class="text-gradient">C√†y m√¥n g√¨ ƒë√¢y?</span>
                </h1>
                
                <p class="hero-desc">
                    ƒê·ª´ng ƒë·ªÉ ng√†y h√¥m nay tr√¥i qua l√£ng ph√≠. M·ªôt ch√∫t n·ªó l·ª±c m·ªói ng√†y s·∫Ω t·∫°o n√™n k·ª≥ t√≠ch. V√†o b√†n h·ªçc th√¥i n√†o!
                </p>
                
                <div class="hero-actions animate__animated animate__fadeInUp animate__delay-1s">
                    <a href="/dashboard" class="btn-main">
                        <i class="fas fa-laptop-house"></i> V√†o Dashboard c√° nh√¢n
                    </a>
                    <a href="/courses" class="btn-outline">
                        <i class="fas fa-search"></i> T√¨m b√†i m·ªõi
                    </a>
                </div>
            </div>

            <div class="hero-visual reveal-holder creative-reveal-right" style="transition-delay: 0.5s">
                <div class="member-card-3d">
                    <div class="member-card-header">
                        <div class="member-avatar-wrapper">
                            <img src="<%= user.avatar || 'https://ui-avatars.com/api/?name=' + user.username + '&background=random' %>" alt="User Avatar">
                            <div class="status-dot"></div>
                        </div>
                        <div class="member-info">
                            <h3><%= user.username %></h3>
                            <span class="member-role"><%= user.role === 'admin' ? 'Qu·∫£n tr·ªã vi√™n' : 'H·ªçc sinh chƒÉm ch·ªâ' %></span>
                        </div>
                    </div>
                    
                    <div class="member-stats-mini">
                        <div class="ms-item">
                            <span class="ms-label">Tr·∫°ng th√°i</span>
                            <span class="ms-value text-success">S·∫µn s√†ng</span>
                        </div>
                        <div class="ms-item">
                            <span class="ms-label">M·ª•c ti√™u</span>
                            <span class="ms-value text-primary">ƒê·∫°i h·ªçc</span>
                        </div>
                    </div>

                    <div class="member-card-footer">
                        <p>Tip: "Kh√¥ng c√≥ √°p l·ª±c, kh√¥ng c√≥ kim c∆∞∆°ng!" üíé</p>
                    </div>
                </div>

                <div class="floating-card fc-1" style="top: -20px; right: 0;">
                    <i class="fas fa-fire text-accent-orange"></i> Gi·ªØ l·ª≠a nh√©!
                </div>
            </div>
        <% } %>

    </div>
</section>

<div class="stats-container reveal-holder creative-reveal-scale" style="transition-delay: 0.8s">
    <div class="stats-box">
        <div class="stat-item">
            <div class="stat-icon"><i class="fas fa-infinity"></i></div>
            <span class="stat-number" style="font-size: 1.8rem;">Mi·ªÖn ph√≠</span>
            <span class="stat-label">Tr·ªçn ƒë·ªùi</span>
        </div>
        <div class="stat-item">
            <div class="stat-icon"><i class="fas fa-shield-alt"></i></div>
            <span class="stat-number" style="font-size: 1.8rem;">Ch·∫•t l∆∞·ª£ng</span>
            <span class="stat-label">Ki·ªÉm duy·ªát k·ªπ</span>
        </div>
        <div class="stat-item">
            <div class="stat-icon"><i class="fas fa-hand-holding-heart"></i></div>
            <span class="stat-number" style="font-size: 1.8rem;">Phi l·ª£i nhu·∫≠n</span>
            <span class="stat-label">V√¨ c·ªông ƒë·ªìng</span>
        </div>
    </div>
</div>

<section class="section">
    <div class="section-head reveal-holder creative-reveal-up">
        <span class="section-tag">ƒê·ªãnh h∆∞·ªõng</span>
        <h2 class="section-title">C√°c m√¥n h·ªçc tr·ªçng t√¢m</h2>
    </div>

    <% if (subjects && subjects.length > 0) { %>
        <div class="subject-grid" style="justify-content: center;">
            <% subjects.forEach((sub, index) => { %>
                <a href="/subjects/<%= sub._id %>" class="subject-card reveal-holder creative-reveal-up" style="transition-delay: <%= index * 100 %>ms">
                    <i class="<%= sub.icon || 'fas fa-book' %>"></i>
                    <div class="subject-name"><%= sub.name %></div>
                </a>
            <% }) %>
            
            <% if (subjects.length < 4) { %>
                <div class="subject-card reveal-holder creative-reveal-up" style="opacity: 0.7; border-style: dashed;">
                    <i class="fas fa-plus-circle text-gray-300"></i>
                    <div class="subject-name text-gray-400">S·∫Øp c·∫≠p nh·∫≠t</div>
                </div>
            <% } %>
        </div>
    <% } else { %>
        <div class="text-center p-8 bg-white rounded-3xl shadow-sm border border-gray-100 reveal-holder creative-reveal-scale">
            <img src="https://cdni.iconscout.com/illustration/premium/thumb/folder-is-empty-4064360-3363921.png" width="120" alt="Empty" class="mx-auto mb-4 opacity-80">
            <p class="text-gray-500 font-medium">Ch√∫ng m√¨nh ƒëang bi√™n so·∫°n danh m·ª•c m√¥n h·ªçc...</p>
        </div>
    <% } %>
</section>

<section class="section">
    <div class="section-head reveal-holder creative-reveal-up">
        <span class="section-tag">V·ª´a ra l√≤</span>
        <h2 class="section-title">Kh√≥a h·ªçc ti√™n phong</h2>
    </div>

    <% if (courses && courses.length > 0) { %>
        <div class="course-grid" style="<%= courses.length < 3 ? 'display: flex; justify-content: center; flex-wrap: wrap;' : '' %>">
            
            <% courses.forEach((course, index) => { %>
                <div class="course-card reveal-holder <%= index % 2 === 0 ? 'creative-reveal-left' : 'creative-reveal-right' %>" 
                     style="transition-delay: <%= index * 150 %>ms; <%= courses.length < 3 ? 'width: 100%; max-width: 380px;' : '' %>">
                    
                    <a href="/course/<%= course._id %>" class="course-img-wrapper">
                        <img src="<%= course.thumbnail || 'https://i.ibb.co/BVnNtLhp/default-course.png' %>" class="course-img" alt="<%= course.title %>" onerror="this.onerror=null;this.src='https://i.ibb.co/BVnNtLhp/default-course.png';">
                        
                        <div class="course-overlay"></div>
                        <span class="course-category-badge">
                            <%= course.subjectId ? course.subjectId.name : 'M·ªõi' %>
                        </span>
                        
                        <div class="course-icon-float">
                            <i class="fas fa-play"></i>
                        </div>
                    </a>

                    <div class="course-content">
                        <div class="course-meta">
                            <span><i class="far fa-calendar-alt"></i> <%= new Date(course.createdAt).toLocaleDateString('vi-VN') %></span>
                            <span class="text-accent-orange font-bold"><i class="fas fa-star me-1"></i> M·ªõi</span>
                        </div>
                        
                        <a href="/course/<%= course._id %>" class="course-title">
                            <%= course.title %>
                        </a>

                        <div class="course-footer">
                            <% 
                                const author = course.author || {}; 
                                const authorName = author.username || 'Ban Bi√™n T·∫≠p';
                                const authorAvatar = author.avatar || `https://ui-avatars.com/api/?name=${authorName}&background=random&color=fff`;
                            %>
                            <div class="author-info">
                                <img src="<%= authorAvatar %>" class="author-avatar" alt="Author">
                                <span class="author-name"><%= authorName %></span>
                            </div>
                            
                            <a href="/course/<%= course._id %>" class="btn-arrow-go">
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            <% }) %>
        </div>
        
        <div class="text-center mt-12 reveal-holder creative-reveal-up">
            <a href="/courses" class="btn-outline px-10 py-4 rounded-full transition font-bold shadow-sm">
                Xem th∆∞ vi·ªán kh√≥a h·ªçc <i class="fas fa-angle-right ms-2"></i>
            </a>
        </div>

    <% } else { %>
        <div class="text-center py-16 px-4 bg-white rounded-[40px] border border-gray-100 shadow-sm reveal-holder creative-reveal-scale mx-auto max-w-2xl">
            <img src="https://cdni.iconscout.com/illustration/premium/thumb/writer-writing-notes-2974917-2477348.png" alt="Be the first" style="width: 250px;" class="mx-auto mb-6">
            <h3 class="text-2xl font-bold text-dark mb-2">Ch∆∞a c√≥ b√†i h·ªçc n√†o</h3>
            <p class="text-gray-500 mb-6">H√£y tr·ªü th√†nh ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë√≥ng g√≥p b√†i gi·∫£ng cho c·ªông ƒë·ªìng!</p>
            <a href="/create-course" class="btn-main">
                <i class="fas fa-plus-circle"></i> T·∫°o b√†i h·ªçc ngay
            </a>
        </div>
    <% } %>
</section>

<section class="features-section">
    <div class="reveal-holder creative-reveal-up">
        <h2 class="text-4xl font-black mb-4">B·∫°n mu·ªën ƒë√≥ng g√≥p?</h2>
        <p class="text-gray-300 text-lg font-medium max-w-2xl mx-auto">
            D√π b·∫°n l√† h·ªçc sinh gi·ªèi hay ch·ªâ ƒë∆°n gi·∫£n mu·ªën chia s·∫ª ghi ch√∫, 
            ch√∫ng m√¨nh lu√¥n ch√†o ƒë√≥n m·ªçi s·ª± ƒë√≥ng g√≥p ƒë·ªÉ x√¢y d·ª±ng kho t√†i li·ªáu chung.
        </p>
    </div>

    <div class="features-grid">
        <div class="feature-card reveal-holder creative-reveal-scale" style="transition-delay: 0ms">
            <div class="feature-icon-box">
                <i class="fas fa-upload"></i>
            </div>
            <h3>Chia s·∫ª t√†i li·ªáu</h3>
            <p>Upload ƒë·ªÅ thi, t√≥m t·∫Øt b√†i h·ªçc ho·∫∑c ghi ch√∫ c√° nh√¢n.</p>
        </div>
        <div class="feature-card reveal-holder creative-reveal-scale" style="transition-delay: 200ms">
            <div class="feature-icon-box">
                <i class="fas fa-pen-nib"></i>
            </div>
            <h3>Vi·∫øt b√†i gi·∫£ng</h3>
            <p>Bi√™n so·∫°n c√°c b√†i h·ªçc tr·ª±c quan, d·ªÖ hi·ªÉu cho c√°c b·∫°n kh√≥a d∆∞·ªõi.</p>
        </div>
        <div class="feature-card reveal-holder creative-reveal-scale" style="transition-delay: 400ms">
            <div class="feature-icon-box">
                <i class="fas fa-heart"></i>
            </div>
            <h3>Lan t·ªèa</h3>
            <p>Gi·ªõi thi·ªáu web ƒë·∫øn b·∫°n b√® ƒë·ªÉ c·ªông ƒë·ªìng ng√†y c√†ng l·ªõn m·∫°nh.</p>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.15 
        };

        const revealObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    observer.unobserve(entry.target); 
                }
            });
        }, observerOptions);

        document.querySelectorAll('.reveal-holder').forEach(el => {
            revealObserver.observe(el);
        });
    });
</script>

<%- include('partials/footer') %>