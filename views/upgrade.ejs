<%- include('partials/header') %>
<link rel="stylesheet" href="/css/styleUpgrade.css">

<div class="upgrade-wrapper">
    
    <div class="upgrade-header" data-animate="fade-down">
        <h1 class="upgrade-title">M·ªü Kh√≥a S·ª©c M·∫°nh ‚ö°</h1>
        <p class="upgrade-subtitle">
            N√¢ng c·∫•p l√™n t√†i kho·∫£n PRO ƒë·ªÉ s·ªü h·ªØu kho t√†ng ki·∫øn th·ª©c kh√¥ng gi·ªõi h·∫°n v√† nh·ªØng ƒë·∫∑c quy·ªÅn "chanh s·∫£" nh·∫•t!
        </p>
    </div>

    <div class="pricing-grid">
        
        <div class="plan-card" data-animate="fade-right">
            <h3>üå± Newbie</h3>
            <div class="plan-price">Mi·ªÖn ph√≠</div>
            <ul class="features-list">
                <li><i class="fas fa-check"></i> Xem b√†i h·ªçc c∆° b·∫£n</li>
                <li><i class="fas fa-check"></i> Tham gia ph√≤ng Live</li>
                <li><i class="fas fa-check"></i> T·∫°o h·ªì s∆° c√° nh√¢n</li>
                <li class="disabled"><i class="fas fa-times"></i> ƒêƒÉng b√†i vi·∫øt (News)</li>
                <li class="disabled"><i class="fas fa-times"></i> T·∫°o ph√≤ng Live Stream</li>
                <li class="disabled"><i class="fas fa-times"></i> Kho ·∫£nh Avatar PRO</li>
                <li class="disabled"><i class="fas fa-times"></i> Huy hi·ªáu VIP l·∫•p l√°nh</li>
            </ul>
        </div>

        <div class="plan-card pro" data-animate="zoom-in">
            <div class="crown-icon">üëë</div>
            <h2 class="pro-title">HTTD PRO</h2>
            <div class="pro-badge">BEST VALUE</div>
            
            <ul class="features-list">
                <li><i class="fas fa-check-circle"></i> <b>T·∫•t c·∫£ quy·ªÅn l·ª£i Newbie</b></li>
                <li><i class="fas fa-check-circle"></i> üöÄ M·ªü ph√≤ng Live Stream ri√™ng</li>
                <li><i class="fas fa-check-circle"></i> ‚úçÔ∏è ƒêƒÉng b√†i vi·∫øt l√™n b·∫£ng tin</li>
                <li><i class="fas fa-check-circle"></i> üé® S·ª≠ d·ª•ng Kho ·∫£nh PRO x·ªãn x√≤</li>
                <li><i class="fas fa-check-circle"></i> ‚ú® Huy hi·ªáu v∆∞∆°ng mi·ªán c·∫°nh t√™n</li>
                <li><i class="fas fa-check-circle"></i> ü§ñ S·ª≠ d·ª•ng AI ch·∫•m ƒëi·ªÉm (S·∫Øp ra m·∫Øt)</li>
            </ul>

            <% if (user && user.isPro) { %>
                <div class="upgrade-form" style="background: #e8f5e9; border-color: #2ecc71;">
                    <h3 style="color: #2e7d32; font-size: 1.2rem; margin-bottom: 10px;">üéâ ƒê√£ k√≠ch ho·∫°t PRO!</h3>
                    <p style="font-size: 0.9rem;">V∆∞∆°ng mi·ªán ƒë√£ ·ªü tr√™n vai b·∫°n.</p>
                    <a href="/" class="btn-upgrade" style="background: #2e7d32; box-shadow: none;">V·ªÅ trang ch·ªß</a>
                </div>
            <% } else { %>
                <form action="/upgrade" method="POST" class="upgrade-form" id="upgradeForm">
                    <p style="font-weight: 700; color: #b45309; margin-bottom: 10px;">
                        <i class="fas fa-key"></i> Nh·∫≠p Secret Key k√≠ch ho·∫°t
                    </p>
                    
                    <div class="key-input-wrapper">
                        <input type="text" name="secretKey" class="setup-input code-input" 
                            placeholder="XXXX-XXXX-XXXX" 
                            required autocomplete="off">
                    </div>

                    <p class="hint-text">Nh·∫≠p m√£ b√≠ m·∫≠t b·∫°n nh·∫≠n ƒë∆∞·ª£c t·ª´ Admin ho·∫∑c Event.</p>

                    <button type="submit" class="btn-upgrade">
                        <i class="fas fa-unlock-alt"></i> M·ªû KH√ìA NGAY
                    </button>
                </form>
            <% } %>
        </div>

    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        // Form Loading State
        const form = document.getElementById('upgradeForm');
        if(form) {
            form.addEventListener('submit', (e) => {
                const btn = form.querySelector('.btn-upgrade');
                if(btn) {
                    btn.disabled = true;
                    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ƒêang x·ª≠ l√Ω...';
                }
            });
        }

        // --- ANIMATION FIX ---
        if (typeof gsap !== 'undefined') {
            // 1. Header
            gsap.fromTo('.upgrade-header', 
                { y: -30, opacity: 0 },
                { y: 0, opacity: 1, duration: 0.8, ease: 'back.out(1.7)', clearProps: 'all' }
            );

            // 2. Card th∆∞·ªùng (B√™n tr√°i)
            gsap.fromTo('.plan-card:not(.pro)', 
                { x: -30, opacity: 0 },
                { x: 0, opacity: 1, duration: 0.8, delay: 0.2, clearProps: 'all' }
            );

            // 3. Card PRO (B√™n ph·∫£i - Quan tr·ªçng)
            // L∆∞u √Ω: scale k·∫øt th√∫c l√† 1.05 v√¨ trong CSS ch√∫ng ta ƒë√£ set transform: scale(1.05)
            gsap.fromTo('.plan-card.pro', 
                { scale: 0.8, opacity: 0 },
                { scale: 1.05, opacity: 1, duration: 0.8, delay: 0.4, ease: 'elastic.out(1, 0.5)', clearProps: 'opacity,visibility' } 
                // Ch·ªâ clear opacity, gi·ªØ l·∫°i transform scale c·ªßa CSS
            );
        } else {
            // Fallback: N·∫øu GSAP kh√¥ng t·∫£i ƒë∆∞·ª£c, √©p hi·ªÉn th·ªã t·∫•t c·∫£
            console.warn("GSAP not loaded. Forcing display.");
            document.querySelectorAll('.upgrade-header, .plan-card').forEach(el => {
                el.style.opacity = '1';
                el.style.visibility = 'visible';
                el.style.transform = 'none';
            });
            // Ri√™ng th·∫ª PRO c·∫ßn scale l·∫°i theo CSS g·ªëc
            const proCard = document.querySelector('.plan-card.pro');
            if(proCard) proCard.style.transform = 'scale(1.05)';
        }
    });
</script>

<%- include('partials/footer') %>