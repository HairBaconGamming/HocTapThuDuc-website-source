<%- include('partials/header') %>
<link rel="stylesheet" href="/css/styleSubjects.css">

<section class="subjects-section">
    <div class="subjects-bg-decor blob-1"></div>
    <div class="subjects-bg-decor blob-2"></div>

    <div class="container">
        <div class="subjects-header">
            <div class="subjects-title">Kho T√†ng Ki·∫øn Th·ª©c</div>
            <p class="subjects-subtitle">Ch·ªçn m·ªôt "m√≥n ƒÉn tinh th·∫ßn" ƒë·ªÉ th∆∞·ªüng th·ª©c h√¥m nay n√†o! üòã</p>
        </div>

        <div class="subjects-grid" id="subjectsGrid">
            <% if (subjects && subjects.length > 0) { %>
                <% 
                   const themes = ['theme-blue', 'theme-pink', 'theme-green', 'theme-yellow', 'theme-purple'];
                %>
                <% subjects.forEach((subject, index) => { 
                    const themeClass = themes[index % themes.length];
                %>
                    <div class="subject-card-pop <%= themeClass %> subject-card-anim">
                        <div class="card-visual">
                            <% if(subject.image) { %>
                                <img src="<%= subject.image %>" alt="<%= subject.name %>" class="card-img" loading="lazy">
                            <% } else { %>
                                <i class="fas fa-book-open" style="font-size: 4rem; color: var(--card-color); opacity: 0.5;"></i>
                            <% } %>
                            <div class="card-sticker">M√¥n h·ªçc</div>
                        </div>

                        <div class="card-body">
                            <h3 class="card-title"><%= subject.name %></h3>
                            <p class="card-desc">
                                <%= subject.description ? subject.description : 'Kh√°m ph√° ngay c√°c b√†i h·ªçc th√∫ v·ªã c·ªßa m√¥n n√†y.' %>
                            </p>
                            <a href="/subjects/<%= subject._id %>" class="card-btn">
                                V√†o h·ªçc ngay <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <div style="grid-column: 1 / -1; text-align: center; padding: 60px;">
                    <div style="font-size: 4rem;">üå±</div>
                    <h3 style="color: #888;">Ch∆∞a c√≥ m√¥n n√†o ƒë∆∞·ª£c gieo tr·ªìng...</h3>
                </div>
            <% } %>
        </div>
    </div>
</section>

<%- include('partials/footer') %>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Ki·ªÉm tra xem th∆∞ vi·ªán GSAP c√≥ load ƒë∆∞·ª£c kh√¥ng
    if (typeof gsap !== 'undefined') {
        // Animation Header
        gsap.from('.subjects-header', {
            duration: 1,
            y: -30,
            opacity: 0,
            ease: 'power2.out'
        });

        // Animation Cards (Stagger)
        // S·ª≠ d·ª•ng autoAlpha thay v√¨ opacity ƒë·ªÉ GSAP t·ª± x·ª≠ l√Ω visibility
        gsap.from('.subject-card-anim', {
            duration: 0.6,
            y: 50,
            autoAlpha: 0, // T·ª± ƒë·ªông set opacity:0 v√† visibility:hidden l√∫c ƒë·∫ßu
            stagger: 0.1, 
            ease: 'back.out(1.2)',
            delay: 0.2,
            clearProps: 'all' // Quan tr·ªçng: X√≥a s·∫°ch style sau khi di·ªÖn xong ƒë·ªÉ tr√°nh l·ªói CSS hover
        });
    } else {
        // Fallback n·∫øu GSAP l·ªói: Hi·ªán t·∫•t c·∫£ ngay l·∫≠p t·ª©c
        document.querySelectorAll('.subject-card-anim').forEach(el => {
            el.style.opacity = 1;
            el.style.transform = 'none';
        });
    }
});
</script>