/* === Artistic Manage Lesson Page CSS V3 === */
/* @import url('/path/to/your/baseStyles.css'); /* Import base styles if available */
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"); /* Example Font */

/* --- Root Variables (Artistic Palette) --- */
:root {
  --font-family-sans: "Inter", sans-serif;

  /* Dark Artistic Theme */
  --artistic-bg-dark: #111827; /* Very Dark Blue/Gray */
  --artistic-bg-medium: #1f2937; /* Dark Gray */
  --artistic-bg-light: #374151; /* Medium Gray */
  --artistic-card-bg: rgba(41, 50, 65, 0.7); /* Semi-transparent card bg */
  --artistic-modal-bg: #272f41; /* Slightly different modal bg */
  --artistic-modal-backdrop: rgba(10, 15, 25, 0.65);

  --artistic-primary: #8b5cf6; /* Vibrant Purple */
  --artistic-primary-rgb: 139, 92, 246;
  --artistic-primary-light: #a78bfa;
  --artistic-secondary: #ec4899; /* Vibrant Pink */
  --artistic-secondary-rgb: 236, 72, 153;
  --artistic-accent: #f59e0b; /* Amber/Gold */
  --artistic-accent-rgb: 245, 158, 11;
  --artistic-success: #10b981; /* Emerald Green */
  --artistic-success-rgb: 16, 185, 129; /* For RGBA */
  --artistic-danger: #ef4444; /* Red */
  --artistic-danger-rgb: 239, 68, 68; /* For RGBA */
  --artistic-warning: #f97316; /* Orange */

  --artistic-text-light: #f3f4f6; /* Light Gray */
  --artistic-text-medium: #9ca3af; /* Medium Gray */
  --artistic-text-dark: #111827; /* For light backgrounds like editor */
  --artistic-border-color: rgba(255, 255, 255, 0.15);
  --artistic-border-color-focus: rgba(var(--artistic-primary-rgb), 0.6);
  --artistic-shadow-color: rgba(0, 0, 0, 0.5);
  --artistic-glow-color: rgba(var(--artistic-primary-rgb), 0.3);

  --header-height-scrolled: 65px; /* Example header height */
  --border-radius-small: 4px;
  --border-radius-medium: 8px;
  --border-radius-large: 16px;

  --transition-duration-fast: 0.2s;
  --transition-duration-medium: 0.35s;
  --transition-duration-slow: 0.5s;
  --transition-ease-out: cubic-bezier(0.165, 0.84, 0.44, 1);
  --transition-ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
}

/* --- Base Body & Font --- */
body {
  font-family: var(--font-family-sans);
  background-color: var(--artistic-bg-dark);
  color: var(--artistic-text-medium);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* --- Section & Background Animation --- */
.manage-lesson-section {
  padding: 80px 20px 100px; /* More padding */
  background: linear-gradient(
    195deg,
    #0f121f 0%,
    /* Darker start */ var(--artistic-bg-dark) 30%,
    #1a1f33 70%,
    #2a2f45 100% /* Lighter end */
  );
  position: relative;
  overflow: hidden; /* Contain background elements and prevent scroll */
  min-height: calc(100vh - var(--header-height-scrolled, 65px));
}

.manage-lesson-background {
  position: absolute;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  pointer-events: none;
}
.bg-element {
  position: absolute;
  border-radius: 50%;
  opacity: 0.08; /* Subtle */
  filter: blur(150px); /* More blur */
  will-change: transform, opacity;
}
.bg-element.element-1 {
  width: 70vmax;
  height: 70vmax;
  background: var(--artistic-primary);
  top: -25%;
  right: -30%;
  animation: pulseAndDrift 40s infinite ease-in-out alternate;
}
.bg-element.element-2 {
  width: 60vmax;
  height: 60vmax;
  background: var(--artistic-secondary);
  bottom: -30%;
  left: -25%;
  animation: pulseAndDrift 55s 2s infinite ease-in-out alternate-reverse; /* Delay second */
}
@keyframes pulseAndDrift {
  0% {
    transform: scale(0.85) translate(0, 0);
    opacity: 0.05;
  }
  50% {
    transform: scale(1.15) translate(8vw, -12vh);
    opacity: 0.1;
  }
  100% {
    transform: scale(0.9) translate(-6vw, 10vh);
    opacity: 0.06;
  }
}

/* --- Main Container Styling --- */
.manage-lesson-container {
  position: relative;
  z-index: 1;
  max-width: 1000px; /* Slightly wider */
  margin: 0 auto;
  background: rgba(31, 41, 55, 0.6); /* --artistic-bg-medium with alpha */
  backdrop-filter: blur(20px) saturate(120%);
  -webkit-backdrop-filter: blur(20px) saturate(120%);
  border: 1px solid var(--artistic-border-color);
  border-radius: var(--border-radius-large);
  padding: 50px 60px; /* More padding */
  box-shadow: 0 20px 60px -10px var(--artistic-shadow-color);
}

/* --- Step Indicator Styling (Enhanced) --- */
.step-indicator {
  display: flex;
  justify-content: center;
  margin-bottom: 45px;
  position: relative;
}
.step {
  display: flex;
  align-items: center;
  flex-direction: column;
  text-align: center;
  position: relative;
  flex: 1;
  max-width: 180px;
}
.step-number {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(var(--artistic-primary-rgb), 0.1);
  border: 1px solid rgba(var(--artistic-primary-rgb), 0.25);
  color: var(--artistic-text-medium);
  font-weight: 600;
  font-size: 1rem;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 10px;
  transition: all 0.4s var(--transition-ease-out);
  z-index: 2;
  position: relative;
}
.step-label {
  font-size: 0.85rem;
  color: var(--artistic-text-medium);
  font-weight: 500;
  transition: color 0.4s ease;
}
.step-connector {
  position: absolute;
  top: 20px; /* Center align */
  left: calc(50% + 30px);
  width: calc(100% - 60px);
  height: 2px;
  background: linear-gradient(
    to right,
    rgba(var(--artistic-primary-rgb), 0.1),
    rgba(var(--artistic-primary-rgb), 0.25)
  );
  z-index: 1;
  transition: background 0.5s ease;
  border-radius: 1px;
}
.step:last-child .step-connector {
  display: none;
}

/* Active/Completed Step Styling */
.step.active .step-number,
.step.completed .step-number {
  background: var(--artistic-primary);
  border-color: var(--artistic-primary);
  color: white;
  box-shadow: 0 0 20px 0 var(--artistic-glow-color);
  transform: scale(1.1);
}
.step.active .step-label,
.step.completed .step-label {
  color: var(--artistic-primary-light);
  font-weight: 600;
}
.step.completed .step-connector {
  background: var(--artistic-primary);
}

/* --- Titles --- */
.main-title {
  text-align: center;
  font-size: clamp(2rem, 5vw, 2.8rem); /* Larger */
  font-weight: 700;
  color: var(--artistic-text-light);
  margin-bottom: 50px;
  letter-spacing: -0.5px;
}
.step-title {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--artistic-secondary); /* Secondary color for step titles */
  margin: 0 0 35px 0;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--artistic-border-color);
}

/* --- Form Steps Wrapper & Steps --- */
.form-steps-wrapper {
  position: relative;
  overflow: hidden; /* Contain step transitions */
  transition: height 0.5s var(--transition-ease-in-out);
  will-change: height;
}
.form-step {
  /* JS handles visibility/position during transition */
  width: 100%;
  /* Add padding inside if needed, or rely on container padding */
}
.form-step:not(.active) {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}
.form-step.active {
  position: relative; /* Takes space */
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* --- Form Grid --- */
.form-grid {
  display: grid;
  gap: 30px;
}
.form-grid.two-columns {
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
}

/* --- Fancy Input Fields (Adapted from V2) --- */
.input-field-group.fancy-input {
  position: relative;
  margin-bottom: 30px;
}

.form-input-v2 {
  width: 100%;
  padding: 14px 20px 14px 50px; /* Slightly more padding */
  background: transparent;
  border: none;
  border-bottom: 1px solid var(--artistic-border-color);
  color: var(--artistic-text-light);
  font-size: 1rem;
  transition: border-color 0.3s ease;
  position: relative;
  z-index: 2;
  outline: none;
}
.form-input-v2::placeholder {
  color: transparent;
} /* Hide placeholder initially */

.form-label-v2 {
  position: absolute;
  top: 14px;
  left: 50px;
  color: var(--artistic-text-medium);
  opacity: 0.9;
  pointer-events: none;
  transition: all 0.3s var(--transition-ease-out);
  z-index: 1;
  font-size: 1rem;
}
.form-label-v2.static {
  /* For selects */
  transform: translateY(-24px) translateX(-50px) scale(0.8);
  color: var(--artistic-primary-light);
  font-size: 0.8rem;
  opacity: 1;
}
.form-input-v2:focus + .form-label-v2:not(.static),
.input-field-group.filled .form-label-v2:not(.static) {
  transform: translateY(-24px) translateX(-50px) scale(0.8);
  color: var(--artistic-primary-light);
  font-size: 0.8rem;
  opacity: 1;
}

.input-focus-line {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(
    90deg,
    var(--artistic-primary),
    var(--artistic-secondary)
  );
  transform: scaleX(0);
  transform-origin: center;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 3;
}
.form-input-v2:focus ~ .input-focus-line {
  transform: scaleX(1);
}

.input-icon {
  position: absolute;
  top: 16px;
  left: 18px;
  color: var(--artistic-text-medium);
  opacity: 0.6;
  transition: all 0.3s ease;
  z-index: 3;
  font-size: 1rem;
}
.form-input-v2:focus ~ .input-icon {
  color: var(--artistic-primary);
  opacity: 1;
}

/* Custom Select Wrapper v2 (Adapted) */
.custom-select-wrapper-v2 {
  position: relative;
  display: flex;
  align-items: center;
  background: transparent;
  border-bottom: 1px solid var(--artistic-border-color);
  transition: border-color 0.3s ease;
}
.custom-select-wrapper-v2 .select-icon {
  color: var(--artistic-text-medium);
  opacity: 0.6;
  padding: 0 18px; /* Icon position */
  font-size: 1rem;
  transition: all 0.3s ease;
  z-index: 3;
}
.custom-select-v2 {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  background: transparent;
  border: none;
  color: var(--artistic-text-light);
  font-size: 1rem;
  padding: 14px 40px 14px 0; /* Space for arrow */
  cursor: pointer;
  outline: none;
  flex-grow: 1;
  width: 100%;
}
.custom-select-v2 option {
  background-color: var(--artistic-bg-medium);
  color: var(--artistic-text-light);
}
.custom-select-wrapper-v2 .select-arrow {
  position: absolute;
  right: 18px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--artistic-text-medium);
  opacity: 0.7;
  pointer-events: none;
  transition: transform 0.3s ease;
  font-size: 0.9rem;
}
.custom-select-wrapper-v2:focus-within,
.custom-select-wrapper-v2:hover {
  border-bottom-color: var(--artistic-border-color-focus);
}
.custom-select-wrapper-v2:focus-within .select-icon,
.custom-select-wrapper-v2:hover .select-icon {
  color: var(--artistic-primary);
  opacity: 1;
}
.custom-select-wrapper-v2:focus-within .select-arrow,
.custom-select-wrapper-v2:hover .select-arrow {
  transform: translateY(-50%) scale(1.2);
  opacity: 1;
}
/* Focus line for select */
.custom-select-wrapper-v2::after {
  content: "";
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(
    90deg,
    var(--artistic-primary),
    var(--artistic-secondary)
  );
  transform: scaleX(0);
  transform-origin: center;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 3;
}
.custom-select-wrapper-v2:focus-within::after {
  transform: scaleX(1);
}

/* Fancy Toggle Switch (Adapted) */
.fancy-toggle-group {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 30px;
}
.switch-v2 {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 32px;
}
.switch-v2 input {
  opacity: 0;
  width: 0;
  height: 0;
}
.slider-v2 {
  position: absolute;
  cursor: pointer;
  inset: 0;
  background-color: rgba(255, 255, 255, 0.1);
  border: 1px solid var(--artistic-border-color);
  transition: all 0.4s var(--transition-ease-out);
}
.slider-v2.round {
  border-radius: 32px;
}
.slider-v2::before {
  /* Knob */
  position: absolute;
  content: "";
  height: 24px;
  width: 24px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Bouncy */
  border-radius: 50%;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}
.slider-v2 .icon-on,
.slider-v2 .icon-off {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8rem;
  transition: opacity 0.4s ease;
  pointer-events: none;
}
.slider-v2 .icon-on {
  right: 9px;
  opacity: 0;
  color: var(--artistic-accent);
}
.slider-v2 .icon-off {
  left: 9px;
  opacity: 1;
  color: rgba(255, 255, 255, 0.6);
}
input:checked + .slider-v2 {
  background-color: var(--artistic-primary);
  border-color: var(--artistic-primary);
  box-shadow: 0 0 15px -2px var(--artistic-glow-color);
}
input:checked + .slider-v2::before {
  transform: translateX(28px);
  background: white;
}
input:checked + .slider-v2 .icon-on {
  opacity: 1;
}
input:checked + .slider-v2 .icon-off {
  opacity: 0;
}
.toggle-label-v2 {
  font-size: 1rem;
  color: var(--artistic-text-light);
  font-weight: 500;
}
.toggle-label-v2 .pro-text-inline {
  color: var(--artistic-accent);
  font-weight: 700;
  font-style: italic;
}

/* Lesson Type Selector Tabs (Adapted) */
.lesson-type-selector-v2 {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 35px;
  border-bottom: 1px solid var(--artistic-border-color);
  padding-bottom: 20px;
}
.type-tab-btn {
  background: rgba(var(--artistic-primary-rgb), 0.08);
  border: 1px solid rgba(var(--artistic-primary-rgb), 0.2);
  color: var(--artistic-text-medium);
  padding: 12px 22px;
  border-radius: var(--border-radius-medium);
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s var(--transition-ease-out);
  position: relative;
  overflow: hidden;
  text-transform: capitalize;
}
.type-tab-btn::before {
  /* Underline effect */
  content: "";
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 3px;
  background: var(--artistic-primary);
  transition: width 0.4s ease;
  border-radius: 2px;
}
.type-tab-btn:hover {
  background: rgba(var(--artistic-primary-rgb), 0.15);
  color: var(--artistic-text-light);
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(var(--artistic-primary-rgb), 0.1);
}
.type-tab-btn.active {
  background: linear-gradient(
    135deg,
    var(--artistic-primary),
    var(--artistic-primary-light)
  );
  color: white;
  font-weight: 700;
  box-shadow: 0 6px 20px -5px var(--artistic-glow-color);
  transform: translateY(-2px);
  border-color: transparent;
}
.type-tab-btn.active::before {
  width: 70%;
}

/* --- Editor Area & Panels --- */
.editor-area {
  margin-top: 30px;
}
.editor-panel {
  /* Visibility handled by JS */
}
.editor-label {
  display: block;
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--artistic-secondary); /* Use secondary color */
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.hidden-data {
  display: none;
}

/* --- NEW: Editor Preview Container Styling --- */
.editor-preview-container {
  position: relative; /* Needed for ::before pseudo-element and overlay */
  border: 1px dashed rgba(var(--artistic-primary-rgb), 0.3);
  border-radius: var(--border-radius-medium);
  padding: 20px 25px;
  background: rgba(0, 0, 0, 0.2);
  min-height: 100px; /* Ensure decent clickable area */
  cursor: pointer;
  transition: all var(--transition-duration-medium) var(--transition-ease-out);
  overflow: hidden; /* Contain overlay */
  margin-bottom: 20px; /* Space below preview */
  will-change: transform, box-shadow, border-color;
}

/* Subtle gradient glow effect on hover */
.editor-preview-container::before {
  content: "";
  position: absolute;
  inset: -1px; /* Cover border */
  border-radius: inherit;
  background: radial-gradient(
    ellipse at center,
    rgba(var(--artistic-primary-rgb), 0.3),
    transparent 70%
  );
  opacity: 0;
  transition: opacity var(--transition-duration-medium) ease;
  z-index: 0;
  pointer-events: none;
}

.editor-preview-container:hover {
  border-color: var(--artistic-border-color-focus);
  background: rgba(var(--artistic-primary-rgb), 0.06);
  transform: translateY(-4px) scale(1.015);
  box-shadow: 0 8px 25px -5px var(--artistic-glow-color);
}
.editor-preview-container:hover::before {
  opacity: 1; /* Show glow */
}

.preview-content {
  position: relative; /* Above pseudo-element */
  z-index: 1;
  color: var(--artistic-text-medium);
  font-size: 1rem;
  line-height: 1.7;
  max-height: 180px; /* Limit preview height */
  overflow-y: auto; /* Allow scrolling for long content */
  /* Custom scrollbar styling (optional) */
  scrollbar-width: thin;
  scrollbar-color: var(--artistic-primary-light) rgba(0, 0, 0, 0.1);
}
/* Webkit scrollbar */
.preview-content::-webkit-scrollbar {
  width: 6px;
}
.preview-content::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.1);
  border-radius: 3px;
}
.preview-content::-webkit-scrollbar-thumb {
  background-color: var(--artistic-primary-light);
  border-radius: 3px;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

/* Styling for rendered Markdown within preview */
.preview-content h1,
.preview-content h2,
.preview-content h3 {
  color: var(--artistic-text-light);
  margin-top: 1em;
  margin-bottom: 0.5em;
  font-weight: 600;
}
.preview-content h1 {
  font-size: 1.4em;
}
.preview-content h2 {
  font-size: 1.2em;
}
.preview-content h3 {
  font-size: 1.1em;
}
.preview-content p {
  margin-bottom: 1em;
}
.preview-content p:last-child {
  margin-bottom: 0;
}
.preview-content strong {
  color: var(--artistic-text-light);
  font-weight: 600;
}
.preview-content em {
  font-style: italic;
  color: var(--artistic-primary-light);
}
.preview-content ul,
.preview-content ol {
  margin-left: 25px;
  margin-bottom: 1em;
}
.preview-content li {
  margin-bottom: 0.4em;
}
.preview-content blockquote {
  border-left: 4px solid var(--artistic-secondary);
  margin: 1em 0;
  padding: 0.5em 1em;
  background: rgba(var(--artistic-secondary-rgb), 0.05);
  color: var(--artistic-text-medium);
  font-style: italic;
}
.preview-content code:not(pre code) {
  background-color: rgba(var(--artistic-text-light), 0.1);
  padding: 0.2em 0.5em;
  border-radius: var(--border-radius-small);
  font-size: 90%;
  color: var(--artistic-accent);
  font-family: monospace;
}
.preview-content pre {
  background-color: rgba(0, 0, 0, 0.3);
  padding: 1em;
  border-radius: var(--border-radius-medium);
  overflow-x: auto;
  margin-bottom: 1em;
}
.preview-content pre code {
  background: none;
  padding: 0;
  font-size: 0.9rem;
  color: var(--artistic-text-light);
}
/* Style KaTeX/MathLive elements inside preview */
.preview-content .katex,
.preview-content .mathlive {
  font-size: 1.1em;
  color: var(--artistic-accent); /* Make math stand out */
  margin: 0 0.2em;
}
.preview-content em:has(> .katex) {
  /* Prevent double italic */
  font-style: normal;
}

/* Edit Overlay */
.edit-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    rgba(var(--artistic-primary-rgb), 0.6),
    rgba(var(--artistic-secondary-rgb), 0.6)
  );
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  font-weight: 700;
  font-size: 1.1rem;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition-duration-medium) ease-in-out;
  border-radius: inherit; /* Match parent radius */
  z-index: 2; /* Above pseudo-element glow */
}
.edit-overlay i {
  font-size: 1.8rem;
  margin-bottom: 8px;
  transform: scale(0.8) translateY(10px);
  transition: transform 0.4s var(--transition-ease-out);
}
.editor-preview-container:hover .edit-overlay {
  opacity: 1;
  pointer-events: auto;
}
.editor-preview-container:hover .edit-overlay i {
  transform: scale(1) translateY(0px);
}

/* --- Quiz & Essay Card Styling (Adapted - No inline editors) --- */
.quiz-question-card,
.essay-question-card {
  background: var(--artistic-card-bg);
  border: 1px solid var(--artistic-border-color);
  border-left: 5px solid var(--artistic-primary); /* Bold accent */
  border-radius: var(--border-radius-medium);
  margin-bottom: 35px; /* Consistent spacing */
  box-shadow: 0 10px 30px -8px var(--artistic-shadow-color);
  position: relative;
  transition: all var(--transition-duration-medium) var(--transition-ease-out);
  overflow: visible; /* Allow hover scale */
}
.quiz-question-card:hover,
.essay-question-card:hover {
  border-color: var(--artistic-border-color-focus);
  transform: translateY(-6px);
  box-shadow: 0 15px 40px -10px rgba(var(--artistic-primary-rgb), 0.25);
}
/* Different accent for essay */
.essay-question-card {
  border-left-color: var(--artistic-accent);
}
.essay-question-card:hover {
  box-shadow: 0 15px 40px -10px rgba(var(--artistic-accent-rgb), 0.2);
}

.quiz-card-header,
.essay-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 25px;
  background: rgba(0, 0, 0, 0.25); /* Darker header */
  border-bottom: 1px solid var(--artistic-border-color);
  border-radius: var(--border-radius-medium) var(--border-radius-medium) 0 0; /* Match card rounding */
}
.question-number {
  font-size: 1rem;
  font-weight: 600;
  color: var(--artistic-primary-light);
  letter-spacing: 0.5px;
}
.essay-card-header .question-number {
  color: var(--artistic-accent);
}

.quiz-card-actions,
.essay-card-header .btn-icon {
  /* Position actions/buttons in header */
  display: flex;
  gap: 10px;
}
/* Icon Button Style (Reused & Enhanced) */
.btn-icon {
  background: transparent;
  border: none;
  color: var(--artistic-text-medium);
  opacity: 0.7;
  font-size: 1.1rem;
  padding: 6px;
  cursor: pointer;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition-duration-fast) ease;
}
.btn-icon:hover {
  opacity: 1;
  color: var(--artistic-text-light);
  background-color: rgba(255, 255, 255, 0.1);
  transform: scale(1.15) rotate(5deg);
}
.remove-question-btn:hover,
.remove-option-btn:hover,
.remove-essay-question-btn:hover {
  color: var(--artistic-danger);
  background-color: rgba(var(--artistic-danger-rgb), 0.15);
}

.quiz-card-body,
.essay-card-body {
  padding: 30px 35px;
  /* No specific styles needed for collapsed state now */
}
/* Form Group & Label Styling within cards */
.quiz-card-body .form-group,
.essay-card-body .form-group {
  margin-bottom: 20px;
}

.quiz-card-body label.form-label,
.essay-card-body label.form-label {
  /* Style labels above previews */
  display: block;
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--artistic-text-medium);
  margin-bottom: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Options Container & Option Card */
.options-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 20px;
  padding-left: 15px;
  border-left: 3px solid rgba(var(--artistic-primary-rgb), 0.2);
}
.quiz-option-card {
  display: flex;
  align-items: flex-start; /* Keep items aligned to the top */
  gap: 15px; /* Reduced gap slightly */
  background: rgba(var(--artistic-bg-dark), 0.5); /* Darker option bg */
  border: 1px solid rgba(var(--artistic-border-color), 0.7);
  border-left: 4px solid var(--artistic-secondary); /* Secondary accent */
  border-radius: var(--border-radius-medium);
  padding: 20px;
  margin-bottom: 0; /* Rely on container gap */
  transition: all var(--transition-duration-medium) var(--transition-ease-out);
}
.quiz-option-card:hover {
  border-color: rgba(var(--artistic-secondary-rgb), 0.5);
  transform: translateX(5px); /* Slight shift */
  box-shadow: 5px 5px 15px -3px rgba(var(--artistic-secondary-rgb), 0.1);
}

.option-content {
  flex-grow: 1; /* Allow this part to take up available space */
  flex-shrink: 1; /* Allow content to shrink if needed, though min-width helps */
  min-width: 0; /* Crucial: Prevents content from forcing parent wider */
}
.option-controls {
    flex-grow: 0; /* Explicitly DON'T allow controls to grow */
    flex-shrink: 0; /* DON'T allow controls to shrink smaller than content */
    flex-basis: auto; /* Calculate width based on content */
    display: flex;
    flex-direction: column; /* Stack checkbox/button vertically */
    align-items: center;   /* Center items horizontally in the column */
    justify-content: flex-start; /* Align items to the top of the column */
    gap: 10px; /* Reduced gap */
    /* padding-top: 5px; Removed, rely on card padding and alignment */
    /* Add a specific width if auto isn't working reliably,
       but 'auto' basis should be correct */
    /* width: 40px; */ /* Example fixed width - use as last resort */
}
/* Ensure the preview container itself doesn't cause issues */
.option-content .editor-preview-container {
    margin-bottom: 0; /* Remove bottom margin if it exists here */
    /* Ensure it doesn't have conflicting width/flex properties */
    width: 100%; /* Take full width of the option-content area */
}

/* --- MULTI-CHOICE CHECKBOX STYLING --- */
.choice-control {
  display: inline-flex;
  align-items: center;
  position: relative;
}
.visually-hidden { /* Make sure this class is defined */
  position: absolute; width: 1px; height: 1px; margin: -1px;
  padding: 0; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0;
}
.correct-answer-label {
   cursor: pointer; display: inline-flex; align-items: center;
   gap: 0.5em; padding: 3px; border-radius: var(--border-radius-medium);
   transition: background-color 0.2s ease;
}
.custom-choice-indicator {
   display: inline-block; width: 22px; height: 22px;
   border: 2px solid var(--artistic-text-medium);
   border-radius: var(--border-radius-small); position: relative;
   background-color: rgba(255, 255, 255, 0.08);
   transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
   flex-shrink: 0;
}
.custom-choice-indicator .check-icon {
   position: absolute; top: 50%; left: 50%;
   transform: translate(-50%, -50%) scale(0); color: white;
   font-size: 14px;
   transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.correct-checkbox:checked + .correct-answer-label .custom-choice-indicator {
   background-color: var(--artistic-success);
   border-color: var(--artistic-success);
}
.correct-checkbox:checked + .correct-answer-label .custom-choice-indicator .check-icon {
   transform: translate(-50%, -50%) scale(1);
}
.correct-answer-label:hover .custom-choice-indicator {
    border-color: var(--artistic-success);
}
.correct-answer-label:hover {
     background-color: rgba(var(--artistic-success-rgb), 0.08);
}
.correct-checkbox:focus-visible + .correct-answer-label .custom-choice-indicator {
    box-shadow: 0 0 0 3px rgba(var(--artistic-success-rgb), 0.4);
    outline: none;
}

.correct-answer-label {
  /* Reusing this class, but it's for the checkbox now */
  cursor: pointer;
  display: inline-flex; /* Ensure label stays with indicator */
  align-items: center;
  gap: 0.5em; /* Adjust gap if needed */
  padding: 3px; /* Allow click area around indicator */
  border-radius: var(--border-radius-medium); /* Rounded click area */
  transition: background-color 0.2s ease;
}

/* Custom checkbox indicator */
.custom-choice-indicator {
  display: inline-block;
  width: 22px; /* Checkbox size */
  height: 22px;
  border: 2px solid var(--artistic-text-medium);
  border-radius: var(--border-radius-small); /* Square-ish */
  position: relative;
  background-color: rgba(255, 255, 255, 0.08);
  transition: background-color 0.2s ease, border-color 0.2s ease,
    box-shadow 0.2s ease;
  flex-shrink: 0; /* Prevent shrinking */
}

.custom-choice-indicator .check-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0); /* Hide check initially */
  color: white;
  font-size: 14px; /* Adjust check size */
  transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1); /* Bouncy */
}

/* Style when checked */
.correct-checkbox:checked + .correct-answer-label .custom-choice-indicator {
  background-color: var(--artistic-success); /* Use success color */
  border-color: var(--artistic-success);
}

.correct-checkbox:checked
  + .correct-answer-label
  .custom-choice-indicator
  .check-icon {
  transform: translate(-50%, -50%) scale(1); /* Show check */
}

/* Hover effects */
.correct-answer-label:hover .custom-choice-indicator {
  border-color: var(--artistic-success);
}
.correct-answer-label:hover {
  background-color: rgba(var(--artistic-success-rgb), 0.08);
}

/* Focus styles for accessibility */
.correct-checkbox:focus-visible
  + .correct-answer-label
  .custom-choice-indicator {
  box-shadow: 0 0 0 3px rgba(var(--artistic-success-rgb), 0.4);
  outline: none;
}

.option-controls .remove-option-btn {
    /* Ensure button size is predictable */
    width: 28px;
    height: 28px;
    padding: 0; /* Reset padding */
    font-size: 0.9rem; /* Adjust icon size */
}

/* AI Feature Box */
.ai-feature-box {
  background: linear-gradient(
    135deg,
    rgba(var(--artistic-primary-rgb), 0.1),
    rgba(var(--artistic-accent-rgb), 0.1)
  );
  border: 1px solid var(--artistic-border-color);
  border-left: 3px solid var(--artistic-accent);
  border-radius: var(--border-radius-medium);
  padding: 25px;
  margin-bottom: 30px;
}
.ai-label {
  display: block;
  font-weight: 600;
  font-size: 1.1rem;
  color: var(--artistic-text-light);
  margin-bottom: 15px;
}
.ai-label .fas {
  margin-right: 10px;
  color: var(--artistic-accent);
}
.ai-controls {
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
}
.ai-file-input {
  /* Style file input nicely */
  color: var(--artistic-text-medium);
  font-size: 0.9rem;
  /* Basic styling - more complex for full customization */
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--artistic-border-color);
  padding: 8px 12px;
  border-radius: var(--border-radius-small);
}
.btn-ai-generate {
  /* Specific button style */
}
.pro-notice {
  color: var(--artistic-secondary);
  font-style: italic;
  font-size: 0.95rem;
  margin-bottom: 25px;
  padding: 10px 15px;
  background: rgba(var(--artistic-secondary-rgb), 0.05);
  border-left: 3px solid var(--artistic-secondary);
  border-radius: var(--border-radius-small);
}
.pro-notice a.pro-text-inline {
  /* Style links within notice */
  color: var(--artistic-secondary);
  text-decoration: underline;
  font-weight: 600;
}
.pro-notice a.pro-text-inline:hover {
  color: var(--artistic-primary-light);
}

/* Essay Section Styling */
.essay-section {
  margin-bottom: 35px;
  padding-bottom: 30px;
  border-bottom: 1px dashed var(--artistic-border-color);
}
.essay-section:last-of-type {
  border-bottom: none;
  margin-bottom: 0;
}
.essay-section h4 {
  /* Section sub-titles */
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--artistic-text-light);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 1px solid rgba(var(--artistic-accent-rgb), 0.3);
  padding-bottom: 10px;
  color: var(--artistic-accent); /* Accent color for sub-titles */
}
.essay-section h4 .fas {
  opacity: 0.8;
}

/* --- Fullscreen Editor Modal Styling --- */
.fullscreen-editor-modal {
  position: fixed;
  inset: 0;
  z-index: 1050; /* High z-index */
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 4vh 4vw; /* Responsive padding */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity var(--transition-duration-medium) ease,
    visibility 0s linear var(--transition-duration-medium);
}
.fullscreen-editor-modal.active {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition-delay: 0s; /* Override delay for showing */
}

.modal-backdrop {
  position: absolute;
  inset: 0;
  background-color: var(--artistic-modal-backdrop);
  backdrop-filter: blur(10px) saturate(90%);
  -webkit-backdrop-filter: blur(10px) saturate(90%);
  cursor: pointer; /* Click backdrop to close */
  opacity: 0; /* Fade in with modal */
  transition: opacity var(--transition-duration-medium) ease;
}
.fullscreen-editor-modal.active .modal-backdrop {
  opacity: 1;
}

.modal-content {
  position: relative;
  z-index: 1051; /* Above backdrop */
  background-color: var(--artistic-modal-bg);
  border: 1px solid var(--artistic-border-color);
  border-radius: var(--border-radius-large);
  box-shadow: 0 25px 70px -15px var(--artistic-shadow-color);
  width: 100%;
  max-width: 1200px; /* Wider max width */
  height: 92vh;
  max-height: 850px; /* Responsive height */
  display: flex;
  flex-direction: column;
  overflow: hidden; /* Contain everything */
  transform: scale(1); /* Final scale */
  opacity: 1; /* Final opacity */
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 30px; /* More padding */
  border-bottom: 1px solid var(--artistic-border-color);
  background: rgba(0, 0, 0, 0.2);
  flex-shrink: 0;
}
#fullscreen-editor-context {
  /* Modal Title */
  margin: 0;
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--artistic-text-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.close-fullscreen-editor {
  background: none;
  border: none;
  color: var(--artistic-text-medium);
  font-size: 1.6rem;
  opacity: 0.7;
  padding: 8px;
  line-height: 1;
  transition: all var(--transition-duration-fast) ease;
  cursor: pointer;
  border-radius: 50%;
}
.close-fullscreen-editor:hover {
  opacity: 1;
  color: var(--artistic-secondary);
  background-color: rgba(var(--artistic-secondary-rgb), 0.1);
  transform: rotate(90deg) scale(1.1);
}

.modal-body {
  padding: 5px; /* Minimal padding, let editor fill */
  flex-grow: 1;
  overflow: hidden; /* Prevent body scroll */
  display: flex; /* Crucial for editor height */
}

#fullscreen-editor-container {
  flex-grow: 1; /* Editor takes all space */
  border-radius: var(
    --border-radius-medium
  ); /* Slightly rounded corners inside */
  overflow: hidden; /* Clip TUI editor corners */
  /* No border needed here if modal-body has padding */
  background-color: #ffffff; /* TUI Editor Background - IMPORTANT */
  display: flex; /* Ensure TUI fills */
  flex-direction: column; /* TUI internal structure */
  min-height: 0; /* Prevent flexbox issues */
}
/* Optional: Editor Loading Placeholder Style */
.editor-loading-placeholder {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100%;
  color: #6c757d;
  font-size: 1.2rem;
}
.editor-loading-placeholder i {
  margin-bottom: 15px;
}

/* Style Toast UI Editor inside the modal (Light Theme) */
#fullscreen-editor-container .toastui-editor-defaultUI {
  border: none !important;
  width: 100%;
  height: 100% !important; /* Fill container */
  display: flex;
  flex-direction: column;
}
#fullscreen-editor-container .toastui-editor-toolbar {
  background-color: #f8f9fa !important;
  border-bottom: 1px solid #dee2e6 !important;
  padding: 5px 10px !important; /* Adjust padding */
  flex-shrink: 0;
  position: relative; /* Ensure toolbar stays on top */
  z-index: 1;
}
/* Style toolbar buttons for better contrast/look */
#fullscreen-editor-container .toastui-editor-toolbar-icons {
  border-color: #e9ecef !important;
  color: #495057 !important;
  margin: 2px !important;
  padding: 6px !important; /* Adjust spacing/padding */
  border-radius: var(--border-radius-small) !important;
}
#fullscreen-editor-container .toastui-editor-toolbar-icons:hover {
  background-color: #e9ecef !important;
  color: #212529 !important;
}
#fullscreen-editor-container .toastui-editor-toolbar-icons.active {
  background-color: #ced4da !important;
  color: #212529 !important;
  border-color: #adb5bd !important;
}
#fullscreen-editor-container .toastui-editor-md-container,
#fullscreen-editor-container .toastui-editor-ww-container {
  flex-grow: 1 !important;
  overflow-y: auto !important; /* Ensure editor content scrolls */
  background-color: #ffffff !important; /* Explicit white bg */
  color: var(--artistic-text-dark) !important; /* Dark text for editor */
  min-height: 0; /* Prevent flexbox overflow issues */
}
/* Style the actual text area */
#fullscreen-editor-container
  .toastui-editor-md-container
  .toastui-editor-contents,
#fullscreen-editor-container
  .toastui-editor-ww-container
  .toastui-editor-contents,
#fullscreen-editor-container .ProseMirror {
  font-family: var(--font-family-sans); /* Match site font */
  font-size: 1rem !important;
  line-height: 1.7 !important;
  padding: 15px 20px !important; /* Editor padding */
  color: var(--artistic-text-dark) !important;
  caret-color: var(--artistic-primary) !important;
}
/* Style preview pane if using vertical preview */
#fullscreen-editor-container .toastui-editor-md-preview {
  background-color: #f8f9fa !important; /* Light gray preview bg */
  padding: 15px 20px !important;
  color: var(--artistic-text-dark) !important;
  font-family: var(--font-family-sans) !important;
  line-height: 1.7 !important;
}

.modal-footer {
  padding: 18px 30px;
  border-top: 1px solid var(--artistic-border-color);
  background: rgba(0, 0, 0, 0.2);
  text-align: right;
  flex-shrink: 0;
}
/* Style modal save button */
#save-and-close-editor {
  padding: 12px 30px;
  font-size: 1rem;
  font-weight: 600;
  /* Use base button styles and add specifics */
}

/* --- Button Styles (Base + Variants) --- */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px 20px;
  font-size: 0.95rem;
  font-weight: 600;
  border-radius: var(--border-radius-medium);
  border: 1px solid transparent;
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  transition: all var(--transition-duration-fast) ease-out;
  position: relative;
  overflow: hidden; /* For effects */
}
.btn i,
.btn .fas,
.btn .fab {
  font-size: 1em; /* Icon size relative to button text */
}

/* Primary Button */
.btn-primary {
  background: linear-gradient(
    135deg,
    var(--artistic-primary),
    var(--artistic-primary-light)
  );
  color: white;
  border: none;
  box-shadow: 0 4px 15px -3px var(--artistic-glow-color);
}
.btn-primary:hover {
  background: linear-gradient(
    135deg,
    var(--artistic-primary-light),
    var(--artistic-primary)
  );
  box-shadow: 0 6px 20px -3px var(--artistic-glow-color);
  transform: translateY(-2px);
}
.btn-primary:active {
  transform: translateY(0);
  box-shadow: 0 2px 10px -2px var(--artistic-glow-color);
}

/* Secondary Button (Add Item) */
.btn-secondary {
  background: rgba(var(--artistic-secondary-rgb), 0.15);
  border: 1px solid rgba(var(--artistic-secondary-rgb), 0.4);
  color: var(--artistic-secondary);
}
.btn-secondary:hover {
  background: rgba(var(--artistic-secondary-rgb), 0.25);
  border-color: var(--artistic-secondary);
  color: var(--artistic-text-light);
  transform: translateY(-2px);
  box-shadow: 0 3px 10px rgba(var(--artistic-secondary-rgb), 0.1);
}
.btn-secondary.add-item-btn {
  font-size: 0.9rem;
  padding: 8px 18px;
} /* Specific size for add */

/* Secondary Outline Button (Back Button, Save Draft) */
.btn-secondary-outline {
  background: transparent;
  border: 1px solid var(--artistic-border-color);
  color: var(--artistic-text-medium);
}
.btn-secondary-outline:hover {
  border-color: var(--artistic-text-light);
  color: var(--artistic-text-light);
  background: rgba(255, 255, 255, 0.05);
}
.btn-save-progress {
  font-size: 0.9rem;
  padding: 8px 18px;
}

/* Submit Button (V2 Style adapted) */
.btn-submit-v2 {
  background: linear-gradient(
    120deg,
    var(--artistic-success) 0%,
    #15803d 100%
  ); /* Green gradient */
  color: white;
  padding: 14px 35px;
  font-size: 1.05rem;
  font-weight: 700;
  border: none;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 5px 20px -4px rgba(var(--artistic-success), 0.4);
  /* Add liquid/particle effects via JS if desired, or keep simple hover */
}
.btn-submit-v2:hover {
  box-shadow: 0 8px 25px -5px rgba(var(--artistic-success-rgb), 0.5);
  transform: translateY(-3px);
}
.btn-submit-v2.submitting {
  opacity: 0.7;
  cursor: wait;
}
.btn-submit-v2.submitting i {
  margin-right: 10px;
} /* Space for spinner */

/* --- Step Navigation --- */
.step-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 40px;
  padding-top: 25px;
  border-top: 1px solid var(--artistic-border-color);
}
.step-navigation.final-step-nav {
  margin-top: 30px;
}

.next-step-btn .fas,
.back-step-btn .fas {
  transition: transform 0.3s ease;
}
.next-step-btn:hover .fa-arrow-right {
  transform: translateX(5px);
}
.back-step-btn:hover .fa-arrow-left {
  transform: translateX(-5px);
}

/* --- Review Step --- */
.review-summary {
  background: rgba(0, 0, 0, 0.2);
  padding: 25px 30px;
  border-radius: var(--border-radius-medium);
  border: 1px solid var(--artistic-border-color);
  margin-bottom: 30px;
}
.review-summary p {
  margin-bottom: 15px;
  font-size: 1rem;
  color: var(--artistic-text-medium);
  display: flex;
}
.review-summary p strong {
  color: var(--artistic-text-light);
  font-weight: 600;
  min-width: 140px;
  display: inline-block;
  margin-right: 10px;
  flex-shrink: 0;
}
.review-summary p span {
  flex-grow: 1;
}
.review-summary p:last-child {
  margin-bottom: 0;
}
.review-prompt {
  color: var(--artistic-text-medium);
  text-align: center;
  margin-bottom: 25px;
  font-style: italic;
}

/* --- Turnstile & Save Progress --- */
.turnstile-container {
  display: flex;
  justify-content: center;
  margin: 35px 0;
}
.save-progress-container {
  text-align: center;
  margin: 25px 0;
}
.btn-save-progress.saved-indicator {
  /* Example feedback */
  background: rgba(var(--artistic-success-rgb), 0.1);
  border-color: var(--artistic-success);
  color: var(--artistic-success);
  animation: pulse-save 1.5s ease-out;
}
@keyframes pulse-save {
  0% {
    box-shadow: 0 0 0 0 rgba(var(--artistic-success-rgb), 0.3);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(var(--artistic-success-rgb), 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(var(--artistic-success-rgb), 0);
  }
}

/* --- Validation Error Styling --- */
.validation-error {
  color: var(--artistic-danger);
  font-size: 0.85rem;
  margin-top: 8px;
  display: none; /* Initially hidden */
  padding-left: 50px; /* Align with input text */
}
/* Show error when associated input is invalid */
input:invalid ~ .validation-error,
select:invalid ~ .validation-error,
textarea:invalid ~ .validation-error {
  display: block;
}
/* Style invalid fields */
input:invalid,
select:invalid,
textarea:invalid {
  border-bottom-color: var(--artistic-danger) !important;
  box-shadow: 0 2px 0 0 var(--artistic-danger) !important; /* Subtle bottom glow */
}
.custom-select-wrapper-v2 select:invalid {
  /* Target select within wrapper */
  border-bottom-color: transparent !important; /* Remove double border */
  box-shadow: none !important;
}
.custom-select-wrapper-v2:has(select:invalid) {
  /* Style wrapper if select is invalid */
  border-bottom-color: var(--artistic-danger) !important;
}
/* Adjust icon color on invalid */
input:invalid ~ .input-icon,
.custom-select-wrapper-v2:has(select:invalid) .select-icon {
  color: var(--artistic-danger);
  opacity: 1;
}

/* --- General Utilities --- */
.text-muted {
  color: var(--artistic-text-medium);
}
.text-danger {
  color: var(--artistic-danger);
}
.text-warning {
  color: var(--artistic-warning);
}
.text-success {
  color: var(--artistic-success);
}
.text-primary {
  color: var(--artistic-primary);
}
.text-center {
  text-align: center;
}
.fw-bold {
  font-weight: 700;
}
.fst-italic {
  font-style: italic;
}
.ms-1 {
  margin-left: 0.25rem;
}
.me-1 {
  margin-right: 0.25rem;
}
.my-4 {
  margin-top: 1.5rem;
  margin-bottom: 1.5rem;
}
.mb-3 {
  margin-bottom: 1rem;
}
/* Add more utilities as needed */

/* --- Artistic Tag Input --- */
.tag-input-container {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 10px 15px;
  background-color: rgba(var(--artistic-bg-dark-rgb), 0.8);
  border: 1px solid var(--artistic-border-color);
  border-radius: var(--border-radius-medium);
  transition: all 0.3s ease;
  cursor: text; /* Biến con trỏ thành dạng text khi di vào container */
}
.tag-input-container:focus-within {
  border-color: var(--artistic-border-color-focus);
  box-shadow: 0 0 0 3px rgba(var(--artistic-primary-rgb), 0.15);
}

.tag-item {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: linear-gradient(135deg, var(--artistic-primary), var(--artistic-secondary));
  color: white;
  padding: 5px 10px;
  border-radius: var(--border-radius-pill);
  font-size: 0.85rem;
  font-weight: 500;
  animation: popIn 0.3s ease forwards;
}
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.remove-tag-btn {
  background: rgba(0,0,0,0.2);
  border: none;
  border-radius: 50%;
  width: 16px;
  height: 16px;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  transition: background-color 0.2s ease, transform 0.2s ease;
}
.remove-tag-btn:hover {
  background: rgba(0,0,0,0.4);
  transform: scale(1.1);
}

.tag-input-field {
  flex-grow: 1;
  border: none;
  outline: none;
  background: transparent;
  color: var(--artistic-text-light);
  font-size: 1rem;
  min-width: 150px; /* Đảm bảo ô input không quá nhỏ */
  padding: 5px 0;
}

/* --- Responsive Adjustments --- */
@media (max-width: 992px) {
  .manage-lesson-container {
    padding: 40px 40px;
  }
  .form-grid.two-columns {
    grid-template-columns: 1fr;
  } /* Stack columns earlier */
}

@media (max-width: 768px) {
  .manage-lesson-section {
    padding: 60px 15px 80px;
  }
  .manage-lesson-container {
    padding: 30px 25px;
  }
  .main-title {
    font-size: clamp(1.8rem, 6vw, 2.2rem);
    margin-bottom: 40px;
  }
  .step-title {
    font-size: 1.5rem;
    margin-bottom: 30px;
  }
  .step-indicator {
    margin-bottom: 35px;
  }
  .step-label {
    display: none;
  } /* Hide labels on mobile */
  .step-number {
    width: 34px;
    height: 34px;
    font-size: 0.9rem;
  }
  .step-connector {
    top: 17px;
    left: calc(50% + 25px);
    width: calc(100% - 50px);
  }
  .lesson-type-selector-v2 {
    flex-wrap: wrap;
    gap: 8px;
    justify-content: flex-start;
  }
  .type-tab-btn {
    flex-basis: calc(50% - 4px);
    justify-content: center;
    font-size: 0.9rem;
    padding: 10px 15px;
  }
  .editor-preview-container {
    padding: 15px;
    min-height: 80px;
  }
  .quiz-card-body,
  .essay-card-body {
    padding: 20px 25px;
  }
  .quiz-option-card {
    padding: 15px;
    gap: 15px;
  }
  .fullscreen-editor-modal {
    padding: 2vh 2vw;
  }
  .modal-content {
    height: 96vh;
    max-height: none;
    border-radius: var(--border-radius-medium);
  }
  .modal-header {
    padding: 15px 20px;
  }
  #fullscreen-editor-context {
    font-size: 1.1rem;
  }
  .modal-body {
    padding: 10px;
  }
  #fullscreen-editor-container .toastui-editor-contents,
  #fullscreen-editor-container .ProseMirror {
    padding: 10px 15px !important;
  }
  .modal-footer {
    padding: 15px 20px;
  }
  #save-and-close-editor {
    padding: 10px 20px;
    font-size: 0.95rem;
  }
  .step-navigation {
    margin-top: 30px;
    padding-top: 20px;
  }
  .btn {
    padding: 9px 18px;
    font-size: 0.9rem;
  }
  .btn-submit-v2 {
    padding: 12px 25px;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .manage-lesson-container {
    padding: 25px 15px;
  }
  .main-title {
    font-size: 1.6rem;
  }
  .step-title {
    font-size: 1.3rem;
  }
  .step-number {
    width: 30px;
    height: 30px;
  }
  .step-connector {
    top: 15px;
    left: calc(50% + 20px);
    width: calc(100% - 40px);
  }
  .type-tab-btn {
    flex-basis: 100%;
  } /* Stack tabs */
  .editor-preview-container {
    padding: 12px 15px;
  }
  .quiz-card-body,
  .essay-card-body {
    padding: 15px 20px;
  }
  .quiz-option-card {
    flex-direction: column;
    align-items: stretch;
  } /* Stack option content & controls */
  .option-controls {
    flex-direction: row;
    justify-content: space-between;
    padding-top: 0;
    margin-top: 10px;
  }
  .step-navigation {
    flex-direction: column-reverse;
    gap: 15px;
  }
  .step-navigation .btn {
    width: 100%;
  } /* Full width buttons */
  .review-summary p {
    flex-direction: column;
  }
  .review-summary p strong {
    min-width: auto;
    margin-bottom: 5px;
  }
  .form-input-v2 {
    padding-left: 40px;
  } /* Less padding for icon */
  .form-label-v2 {
    left: 40px;
  }
  .form-input-v2:focus + .form-label-v2:not(.static),
  .input-field-group.filled .form-label-v2:not(.static) {
    transform: translateY(-22px) translateX(-40px) scale(0.75);
  }
  .input-icon {
    left: 12px;
    top: 14px;
  }
  .custom-select-wrapper-v2 .select-icon {
    padding: 0 12px;
  }
  .custom-select-v2 {
    padding-right: 30px;
  }
  .custom-select-wrapper-v2 .select-arrow {
    right: 12px;
  }
  .validation-error {
    padding-left: 15px; /* No icon padding needed */
  }
}
